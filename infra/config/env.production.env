# ──────────────────────────────────────────────────────
# DEX Exchange — Production Environment Configuration
# ──────────────────────────────────────────────────────
# ALL secrets MUST be injected from Sealed Secrets.
# DO NOT commit actual values.
# ──────────────────────────────────────────────────────

# ─── Global ──────────────────────────────────────────
ENVIRONMENT=production
LOG_LEVEL=warn
RUST_LOG=warn,gateway=info,matching_engine=info

# ─── Gateway ─────────────────────────────────────────
GATEWAY_HOST=0.0.0.0
GATEWAY_PORT=8080
GATEWAY_JWT_SECRET=${JWT_SECRET}
GATEWAY_JWT_EXPIRY_SECONDS=900
GATEWAY_CORS_ORIGINS=https://dex.exchange

# ─── Matching Engine ────────────────────────────────
MATCHING_ENGINE_HOST=0.0.0.0
MATCHING_ENGINE_PORT=8081
MATCHING_ENGINE_SYMBOLS=BTC/USDT,ETH/USDT,SOL/USDT

# ─── Market Data ────────────────────────────────────
MARKET_DATA_HOST=0.0.0.0
MARKET_DATA_PORT=8082
MARKET_DATA_WS_PORT=8085
MARKET_DATA_OHLCV_INTERVALS=1s,1m,5m,15m,1h,4h,1d

# ─── Risk Engine ────────────────────────────────────
RISK_ENGINE_HOST=0.0.0.0
RISK_ENGINE_PORT=8083
RISK_ENGINE_MONITOR_INTERVAL_MS=1000
RISK_ENGINE_MAX_LEVERAGE=20

# ─── Persistence ────────────────────────────────────
PERSISTENCE_HOST=0.0.0.0
PERSISTENCE_PORT=8084
PERSISTENCE_CHECKPOINT_INTERVAL_SECS=60
PERSISTENCE_SNAPSHOT_EVERY_N_EVENTS=1000000

# ─── Redis ──────────────────────────────────────────
REDIS_URL=${REDIS_URL}
REDIS_MAX_CONNECTIONS=200

# ─── Database ───────────────────────────────────────
DATABASE_URL=${DATABASE_URL}
DATABASE_MAX_CONNECTIONS=100
DATABASE_MIN_CONNECTIONS=20
DATABASE_CONNECT_TIMEOUT_SECS=5

# ─── Monitoring ─────────────────────────────────────
METRICS_ENABLED=true
METRICS_PORT=9100
HEALTH_CHECK_INTERVAL_SECS=10

# ─── Rate Limiting (per spec §18) ───────────────────
RATE_LIMIT_MARKET_DATA_RPM=100
RATE_LIMIT_ACCOUNT_QUERIES_RPM=60
RATE_LIMIT_ORDER_PLACEMENT_RPS=20
RATE_LIMIT_ORDER_CANCEL_RPS=50
RATE_LIMIT_WITHDRAWAL_RPH=10

# ─── Circuit Breaker (per spec §10) ────────────────
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_HALF_OPEN_TIMEOUT_SECS=30
CIRCUIT_BREAKER_SUCCESS_THRESHOLD=3

# ─── Retry Policy (per spec §10) ───────────────────
RETRY_MAX_ATTEMPTS=6
RETRY_BASE_DELAY_MS=100
RETRY_MAX_DELAY_MS=3200
RETRY_JITTER_MS=50

# ─── Chain ──────────────────────────────────────────
CHAIN_RPC_URL=${CHAIN_RPC_URL}
CHAIN_NETWORK=mainnet
CHAIN_CONFIRMATION_BLOCKS=12
